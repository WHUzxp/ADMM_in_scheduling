function [Xa,Ploss,Volta,Qg]=program_a(lagrant_a,xigma,Xa_last)
%%%区域a,节点33,1-7,18-25
%%耦合为Xa=[U(6),U(7),P(7),Q(7),U(5),U(25),P(25),Q(25)]
L=[1,2,3,4,5,6,7,18,19,20,21,22,23,24];
N=[33,1,2,3,4,5,6,7,18,19,20,21,22,23,24,25];
Pload=100*[0.00100000000000000;0.000900000000000000;0.00120000000000000;0.000600000000000000;0.000600000000000000;0.00200000000000000;0.00200000000000000;0.000600000000000000;0.000600000000000000;0.000450000000000000;0.000600000000000000;0.000600000000000000;0.00120000000000000;0.000600000000000000;0.000600000000000000;0.000600000000000000;0.000900000000000000;0.000900000000000000;0.000900000000000000;0.000900000000000000;0.000900000000000000;0.000900000000000000;0.00420000000000000;0.00420000000000000;0.000600000000000000;0.000600000000000000;0.000600000000000000;0.00120000000000000;0.00200000000000000;0.00150000000000000;0.00210000000000000;0.000600000000000000;0];
Qload=100*[0.000600000000000000;0.000400000000000000;0.000800000000000000;0.000300000000000000;0.000200000000000000;0.00100000000000000;0.00100000000000000;0.000200000000000000;0.000200000000000000;0.000300000000000000;0.000350000000000000;0.000350000000000000;0.000800000000000000;0.000100000000000000;0.000200000000000000;0.000200000000000000;0.000400000000000000;0.000400000000000000;0.000400000000000000;0.000400000000000000;0.000400000000000000;0.000500000000000000;0.00200000000000000;0.00200000000000000;0.000250000000000000;0.000250000000000000;0.000200000000000000;0.000700000000000000;0.00600000000000000;0.000700000000000000;0.00100000000000000;0.000400000000000000;0];
Line=[33.0000000000000 + 0.00000000000000i,1.00000000000000 + 0.00000000000000i,0.0922000000000000 + 0.0470000000000000i;1.00000000000000 + 0.00000000000000i,2.00000000000000 + 0.00000000000000i,0.493000000000000 + 0.251100000000000i;2.00000000000000 + 0.00000000000000i,3.00000000000000 + 0.00000000000000i,0.366000000000000 + 0.186400000000000i;3.00000000000000 + 0.00000000000000i,4.00000000000000 + 0.00000000000000i,0.381100000000000 + 0.194100000000000i;4.00000000000000 + 0.00000000000000i,5.00000000000000 + 0.00000000000000i,0.819000000000000 + 0.707000000000000i;5.00000000000000 + 0.00000000000000i,6.00000000000000 + 0.00000000000000i,0.187200000000000 + 0.618800000000000i;6.00000000000000 + 0.00000000000000i,7.00000000000000 + 0.00000000000000i,0.711400000000000 + 0.235100000000000i;7.00000000000000 + 0.00000000000000i,8.00000000000000 + 0.00000000000000i,1.03000000000000 + 0.740000000000000i;8.00000000000000 + 0.00000000000000i,9.00000000000000 + 0.00000000000000i,1.04400000000000 + 0.740000000000000i;9.00000000000000 + 0.00000000000000i,10.0000000000000 + 0.00000000000000i,0.196600000000000 + 0.0650000000000000i;10.0000000000000 + 0.00000000000000i,11.0000000000000 + 0.00000000000000i,0.374400000000000 + 0.123800000000000i;11.0000000000000 + 0.00000000000000i,12.0000000000000 + 0.00000000000000i,1.46800000000000 + 1.15500000000000i;12.0000000000000 + 0.00000000000000i,13.0000000000000 + 0.00000000000000i,0.541600000000000 + 0.712900000000000i;13.0000000000000 + 0.00000000000000i,14.0000000000000 + 0.00000000000000i,0.591000000000000 + 0.526000000000000i;14.0000000000000 + 0.00000000000000i,15.0000000000000 + 0.00000000000000i,0.746300000000000 + 0.545000000000000i;15.0000000000000 + 0.00000000000000i,16.0000000000000 + 0.00000000000000i,1.28900000000000 + 1.72100000000000i;16.0000000000000 + 0.00000000000000i,17.0000000000000 + 0.00000000000000i,0.372000000000000 + 0.574000000000000i;1.00000000000000 + 0.00000000000000i,18.0000000000000 + 0.00000000000000i,0.164000000000000 + 0.156500000000000i;18.0000000000000 + 0.00000000000000i,19.0000000000000 + 0.00000000000000i,1.50420000000000 + 1.35540000000000i;19.0000000000000 + 0.00000000000000i,20.0000000000000 + 0.00000000000000i,0.409500000000000 + 0.478400000000000i;20.0000000000000 + 0.00000000000000i,21.0000000000000 + 0.00000000000000i,0.708900000000000 + 0.937300000000000i;2.00000000000000 + 0.00000000000000i,22.0000000000000 + 0.00000000000000i,0.451200000000000 + 0.308300000000000i;22.0000000000000 + 0.00000000000000i,23.0000000000000 + 0.00000000000000i,0.898000000000000 + 0.709100000000000i;23.0000000000000 + 0.00000000000000i,24.0000000000000 + 0.00000000000000i,0.896000000000000 + 0.701100000000000i;5.00000000000000 + 0.00000000000000i,25.0000000000000 + 0.00000000000000i,0.203000000000000 + 0.103400000000000i;25.0000000000000 + 0.00000000000000i,26.0000000000000 + 0.00000000000000i,0.284200000000000 + 0.144700000000000i;26.0000000000000 + 0.00000000000000i,27.0000000000000 + 0.00000000000000i,1.05900000000000 + 0.933700000000000i;27.0000000000000 + 0.00000000000000i,28.0000000000000 + 0.00000000000000i,0.804200000000000 + 0.700600000000000i;28.0000000000000 + 0.00000000000000i,29.0000000000000 + 0.00000000000000i,0.507500000000000 + 0.258500000000000i;29.0000000000000 + 0.00000000000000i,30.0000000000000 + 0.00000000000000i,0.974400000000000 + 0.963000000000000i;30.0000000000000 + 0.00000000000000i,31.0000000000000 + 0.00000000000000i,0.310500000000000 + 0.361900000000000i;31.0000000000000 + 0.00000000000000i,32.0000000000000 + 0.00000000000000i,0.341000000000000 + 0.536200000000000i];
Line(:,3)=Line(:,3)/(12.66^2);
r=real(Line(:,3));
x=imag(Line(:,3));
P=sdpvar(32,1);
Q=sdpvar(32,1);
U=sdpvar(33,1);
Qg=sdpvar(33,1);
Xa=[U(6);U(7);P(7);Q(7);U(5);U(25);P(25);Q(25)];
Pg=[0;0;0;0;0;0;400;0;0;0;400;0;0;0;400;0;0;0;0;400;0;0;0;0;0;0;0;0;400;0;0;0;0]/1000;
Qgm=[0;0;0;0;0;0;400;0;0;0;400;0;0;0;400;0;0;0;0;400;0;0;0;0;0;0;0;0;400;0;0;0;0]/1000;
Ploss=(P.^2+Q.^2).*r;
f=sum(Ploss(L))+sum(lagrant_a.*(Xa-Xa_last))+0.5*xigma*norm(Xa-Xa_last,2)^2;
C=[U(33)==1,U>=0.95*0.95,U<=1.05*1.05,Qg>=-Qgm,Qg<=Qgm];
%%%%有功基尔霍夫
C=[C,P(1)==P(2)+P(18)+Pload(1)-Pg(1),
    P(2)==P(3)+P(22)+Pload(2)-Pg(2),
    P(3)==P(4)+Pload(3)-Pg(3),
    P(4)==P(5)+Pload(4)-Pg(4),
    P(5)==P(6)+P(25)+Pload(5)-Pg(5),
    P(6)==P(7)+Pload(6)-Pg(6),
    P(18)==P(19)+Pload(18)-Pg(18),
    P(19)==P(20)+Pload(19)-Pg(19),
    P(20)==P(21)+Pload(20)-Pg(20),
    P(21)==Pload(21)-Pg(21),
    P(22)==P(23)+Pload(22)-Pg(22),
    P(23)==P(24)+Pload(23)-Pg(23),
    P(24)==Pload(24)-Pg(24)];
%%%无功基尔霍夫
C=[C,Q(1)==Q(2)+Q(18)+Qload(1)-Qg(1),
    Q(2)==Q(3)+Q(22)+Qload(2)-Qg(2),
    Q(3)==Q(4)+Qload(3)-Qg(3),
    Q(4)==Q(5)+Qload(4)-Qg(4),
    Q(5)==Q(6)+Q(25)+Qload(5)-Qg(5),
    Q(6)==Q(7)+Qload(6)-Qg(6),
    Q(18)==Q(19)+Qload(18)-Qg(18),
    Q(19)==Q(20)+Qload(19)-Qg(19),
    Q(20)==Q(21)+Qload(20)-Qg(20),
    Q(21)==Qload(21)-Qg(21),
    Q(22)==Q(23)+Qload(22)-Qg(22),
    Q(23)==Q(24)+Qload(23)-Qg(23),
    Q(24)==Qload(24)-Qg(24)];
%%%电压降落
C=[C,U(1)==U(33)-2*(P(1)*r(1)+Q(1)*x(1)),
    U(2)==U(1)-2*(P(2)*r(2)+Q(2)*x(2)),
    U(3)==U(2)-2*(P(3)*r(3)+Q(3)*x(3)),
    U(4)==U(3)-2*(P(4)*r(4)+Q(4)*x(4)),
    U(5)==U(4)-2*(P(5)*r(5)+Q(5)*x(5)),
    U(6)==U(5)-2*(P(6)*r(6)+Q(6)*x(6)),
    U(7)==U(6)-2*(P(7)*r(7)+Q(7)*x(7)),
    U(18)==U(1)-2*(P(18)*r(18)+Q(18)*x(18)),
    U(19)==U(18)-2*(P(19)*r(19)+Q(19)*x(19)),
    U(20)==U(19)-2*(P(20)*r(20)+Q(20)*x(20)),
    U(21)==U(20)-2*(P(21)*r(21)+Q(21)*x(21)),
    U(22)==U(2)-2*(P(22)*r(22)+Q(22)*x(22)),
    U(23)==U(22)-2*(P(23)*r(23)+Q(23)*x(23)),
    U(24)==U(23)-2*(P(24)*r(24)+Q(24)*x(24))];
ops=sdpsettings('solver','gurobi','verbose',0);
result=solvesdp(C,f,ops);
Volta=sqrt(double(U));
Qg=1000*double(Qg);
Ploss=1000*double(Ploss);
Xa=double(Xa);
end