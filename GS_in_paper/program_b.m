function [Xb,Ploss,Volta,Qg]=program_b(lagrant_b,xigma,Xb_last)
%%%区域b,节点6-17
%%耦合为Xb=[U(6),U(7),P(7),Q(7)]
L=[7,8,9,10,11,12,13,14,15,16,17];
N=[6,7,8,9,10,11,12,13,14,15,16,17];
Pload=100*[0.00100000000000000;0.000900000000000000;0.00120000000000000;0.000600000000000000;0.000600000000000000;0.00200000000000000;0.00200000000000000;0.000600000000000000;0.000600000000000000;0.000450000000000000;0.000600000000000000;0.000600000000000000;0.00120000000000000;0.000600000000000000;0.000600000000000000;0.000600000000000000;0.000900000000000000;0.000900000000000000;0.000900000000000000;0.000900000000000000;0.000900000000000000;0.000900000000000000;0.00420000000000000;0.00420000000000000;0.000600000000000000;0.000600000000000000;0.000600000000000000;0.00120000000000000;0.00200000000000000;0.00150000000000000;0.00210000000000000;0.000600000000000000;0];
Qload=100*[0.000600000000000000;0.000400000000000000;0.000800000000000000;0.000300000000000000;0.000200000000000000;0.00100000000000000;0.00100000000000000;0.000200000000000000;0.000200000000000000;0.000300000000000000;0.000350000000000000;0.000350000000000000;0.000800000000000000;0.000100000000000000;0.000200000000000000;0.000200000000000000;0.000400000000000000;0.000400000000000000;0.000400000000000000;0.000400000000000000;0.000400000000000000;0.000500000000000000;0.00200000000000000;0.00200000000000000;0.000250000000000000;0.000250000000000000;0.000200000000000000;0.000700000000000000;0.00600000000000000;0.000700000000000000;0.00100000000000000;0.000400000000000000;0];
Line=[33.0000000000000 + 0.00000000000000i,1.00000000000000 + 0.00000000000000i,0.0922000000000000 + 0.0470000000000000i;1.00000000000000 + 0.00000000000000i,2.00000000000000 + 0.00000000000000i,0.493000000000000 + 0.251100000000000i;2.00000000000000 + 0.00000000000000i,3.00000000000000 + 0.00000000000000i,0.366000000000000 + 0.186400000000000i;3.00000000000000 + 0.00000000000000i,4.00000000000000 + 0.00000000000000i,0.381100000000000 + 0.194100000000000i;4.00000000000000 + 0.00000000000000i,5.00000000000000 + 0.00000000000000i,0.819000000000000 + 0.707000000000000i;5.00000000000000 + 0.00000000000000i,6.00000000000000 + 0.00000000000000i,0.187200000000000 + 0.618800000000000i;6.00000000000000 + 0.00000000000000i,7.00000000000000 + 0.00000000000000i,0.711400000000000 + 0.235100000000000i;7.00000000000000 + 0.00000000000000i,8.00000000000000 + 0.00000000000000i,1.03000000000000 + 0.740000000000000i;8.00000000000000 + 0.00000000000000i,9.00000000000000 + 0.00000000000000i,1.04400000000000 + 0.740000000000000i;9.00000000000000 + 0.00000000000000i,10.0000000000000 + 0.00000000000000i,0.196600000000000 + 0.0650000000000000i;10.0000000000000 + 0.00000000000000i,11.0000000000000 + 0.00000000000000i,0.374400000000000 + 0.123800000000000i;11.0000000000000 + 0.00000000000000i,12.0000000000000 + 0.00000000000000i,1.46800000000000 + 1.15500000000000i;12.0000000000000 + 0.00000000000000i,13.0000000000000 + 0.00000000000000i,0.541600000000000 + 0.712900000000000i;13.0000000000000 + 0.00000000000000i,14.0000000000000 + 0.00000000000000i,0.591000000000000 + 0.526000000000000i;14.0000000000000 + 0.00000000000000i,15.0000000000000 + 0.00000000000000i,0.746300000000000 + 0.545000000000000i;15.0000000000000 + 0.00000000000000i,16.0000000000000 + 0.00000000000000i,1.28900000000000 + 1.72100000000000i;16.0000000000000 + 0.00000000000000i,17.0000000000000 + 0.00000000000000i,0.372000000000000 + 0.574000000000000i;1.00000000000000 + 0.00000000000000i,18.0000000000000 + 0.00000000000000i,0.164000000000000 + 0.156500000000000i;18.0000000000000 + 0.00000000000000i,19.0000000000000 + 0.00000000000000i,1.50420000000000 + 1.35540000000000i;19.0000000000000 + 0.00000000000000i,20.0000000000000 + 0.00000000000000i,0.409500000000000 + 0.478400000000000i;20.0000000000000 + 0.00000000000000i,21.0000000000000 + 0.00000000000000i,0.708900000000000 + 0.937300000000000i;2.00000000000000 + 0.00000000000000i,22.0000000000000 + 0.00000000000000i,0.451200000000000 + 0.308300000000000i;22.0000000000000 + 0.00000000000000i,23.0000000000000 + 0.00000000000000i,0.898000000000000 + 0.709100000000000i;23.0000000000000 + 0.00000000000000i,24.0000000000000 + 0.00000000000000i,0.896000000000000 + 0.701100000000000i;5.00000000000000 + 0.00000000000000i,25.0000000000000 + 0.00000000000000i,0.203000000000000 + 0.103400000000000i;25.0000000000000 + 0.00000000000000i,26.0000000000000 + 0.00000000000000i,0.284200000000000 + 0.144700000000000i;26.0000000000000 + 0.00000000000000i,27.0000000000000 + 0.00000000000000i,1.05900000000000 + 0.933700000000000i;27.0000000000000 + 0.00000000000000i,28.0000000000000 + 0.00000000000000i,0.804200000000000 + 0.700600000000000i;28.0000000000000 + 0.00000000000000i,29.0000000000000 + 0.00000000000000i,0.507500000000000 + 0.258500000000000i;29.0000000000000 + 0.00000000000000i,30.0000000000000 + 0.00000000000000i,0.974400000000000 + 0.963000000000000i;30.0000000000000 + 0.00000000000000i,31.0000000000000 + 0.00000000000000i,0.310500000000000 + 0.361900000000000i;31.0000000000000 + 0.00000000000000i,32.0000000000000 + 0.00000000000000i,0.341000000000000 + 0.536200000000000i];
Line(:,3)=Line(:,3)/(12.66^2);
r=real(Line(:,3));
x=imag(Line(:,3));
P=sdpvar(32,1);
Q=sdpvar(32,1);
U=sdpvar(33,1);
Qg=sdpvar(33,1);
Xb=[U(6);U(7);P(7);Q(7)];
Pg=[0;0;0;0;0;0;400;0;0;0;400;0;0;0;400;0;0;0;0;400;0;0;0;0;0;0;0;0;400;0;0;0;0]/1000;
Qgm=[0;0;0;0;0;0;400;0;0;0;400;0;0;0;400;0;0;0;0;400;0;0;0;0;0;0;0;0;400;0;0;0;0]/1000;
Ploss=(P.^2+Q.^2).*r;
f=sum(Ploss(L))+0.5*xigma*norm(Xb-Xb_last+lagrant_b,2)^2;
C=[U(33)==1,U>=0.95*0.95,U<=1.05*1.05,Qg>=-Qgm,Qg<=Qgm];
%%%%有功基尔霍夫
C=[C,P(7)==P(8)+Pload(7)-Pg(7),
    P(8)==P(9)+Pload(8)-Pg(8),
    P(9)==P(10)+Pload(9)-Pg(9),
    P(10)==P(11)+Pload(10)-Pg(10),
    P(11)==P(12)+Pload(11)-Pg(11),
    P(12)==P(13)+Pload(12)-Pg(12),
    P(13)==P(14)+Pload(13)-Pg(13),
    P(14)==P(15)+Pload(14)-Pg(14),
    P(15)==P(16)+Pload(15)-Pg(15),
    P(16)==P(17)+Pload(16)-Pg(16),
    P(17)==Pload(17)-Pg(17)];
%%%无功基尔霍夫
C=[C,Q(7)==Q(8)+Qload(7)-Qg(7),
    Q(8)==Q(9)+Qload(8)-Qg(8),
    Q(9)==Q(10)+Qload(9)-Qg(9),
    Q(10)==Q(11)+Qload(10)-Qg(10),
    Q(11)==Q(12)+Qload(11)-Qg(11),
    Q(12)==Q(13)+Qload(12)-Qg(12),
    Q(13)==Q(14)+Qload(13)-Qg(13),
    Q(14)==Q(15)+Qload(14)-Qg(14),
    Q(15)==Q(16)+Qload(15)-Qg(15),
    Q(16)==Q(17)+Qload(16)-Qg(16),
    Q(17)==Qload(17)-Qg(17)];
%%%电压降落
C=[C,U(7)==U(6)-2*(P(7)*r(7)+Q(7)*x(7)),
    U(8)==U(7)-2*(P(8)*r(8)+Q(8)*x(8)),
    U(9)==U(8)-2*(P(9)*r(9)+Q(9)*x(9)),
    U(10)==U(9)-2*(P(10)*r(10)+Q(10)*x(10)),
    U(11)==U(10)-2*(P(11)*r(11)+Q(11)*x(11)),
    U(12)==U(11)-2*(P(12)*r(12)+Q(12)*x(12)),
    U(13)==U(12)-2*(P(13)*r(13)+Q(13)*x(13)),
    U(14)==U(13)-2*(P(14)*r(14)+Q(14)*x(14)),
    U(15)==U(14)-2*(P(15)*r(15)+Q(15)*x(15)),
    U(16)==U(15)-2*(P(16)*r(16)+Q(16)*x(16)),
    U(17)==U(16)-2*(P(17)*r(17)+Q(17)*x(17))];
ops=sdpsettings('solver','cplex','verbose',0);
result=solvesdp(C,f,ops);
Volta=sqrt(double(U));
Qg=1000*double(Qg);
Ploss=1000*double(Ploss);
Xb=double(Xb);
end